{"title":"Canvas实现文字粒子效果","uid":"f05f533c1133c025c502733d54123419","slug":"Canvas实现文字粒子效果","date":"2019-03-29T06:45:12.000Z","updated":"2023-12-18T13:29:06.010Z","comments":true,"path":"api/articles/Canvas实现文字粒子效果.json","keywords":null,"cover":[],"content":"<p>最终实现效果</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/15262297-10ecaf3d3baec6ad.gif?imageMogr2/auto-orient/strip\" alt=\"文字粒子\"></p>\n<p><strong>实现思路：</strong></p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>获取到canvas绘制后屏幕上像素点的数组，在目标像素点上绘制粒子替换掉原来的内容</p></blockquote>\n<ul>\n<li>绘制文字</li>\n<li>通过API获取画布的二进制数组</li>\n<li>设置粒子的填充步长</li>\n<li>添加粒子</li>\n<li>循环的遍历粒子，更新粒子的状态</li>\n</ul>\n<p><strong>代码实现</strong></p>\n<p><strong>绘制文字</strong></p>\n<div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">   </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">textAlign</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;center&quot;</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">   </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">font</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;px arial&quot;</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">   </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">fillText</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">text</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">);</span></span></code></pre></div><p><strong>获取<code>二进制</code>数组</strong></p>\n<div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">   </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">idata</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">getImageData</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">); </span><span style=\"color: #7F848E; font-style: italic\">// 获取 canvas指定范围内的 像素数组</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">   </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">buffer32</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">Uint32Array</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">idata</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">data</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">buffer</span><span style=\"color: #ABB2BF\">); </span><span style=\"color: #7F848E; font-style: italic\">// 转成32位的数组</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>这里使用的<code>getImageData()</code>方法是获取画布内所有的像素点的<code>二进制</code>表示，在JS中使用<code>Uint32Array</code>来接收，已数组形式展现，没有渲染的地方数组值是0，有渲染的地方为一个非0的数字</p></blockquote>\n<p><strong>填充粒子</strong></p>\n<div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// 遍历所有的数组 </span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">j</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">j</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">j</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">gridY</span><span style=\"color: #ABB2BF\">) &#123;</span><span style=\"color: #7F848E; font-style: italic\">//步长</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">gridX</span><span style=\"color: #ABB2BF\">) &#123;</span><span style=\"color: #7F848E; font-style: italic\">//步长</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">buffer32</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #E06C75\">j</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">*</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\">]) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #7F848E; font-style: italic\">// 放入粒子对象</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">ball</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">Particle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">j</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">placement</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">push</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">ball</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">      &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\"> &#125;</span></span></code></pre></div><blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>这里的意思是在二进制数组中某一个范围内的粒子的密度，其中步长越小越密集</p></blockquote>\n<p><strong>更新粒子状态</strong></p>\n<div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">(</span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">drawFrame</span><span style=\"color: #ABB2BF\">() &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">window</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">requestAnimationFrame</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">drawFrame</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">clearRect</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">word</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">placement</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">length</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">i</span><span style=\"color: #56B6C2\">++</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #7F848E; font-style: italic\">//调用particle对像的drawParticle方法，开始画布上画</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">word</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">placement</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\">].</span><span style=\"color: #61AFEF\">drawParticle</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&#125;())</span></span></code></pre></div><div class=\"language-js\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">js</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">drawParticle</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> () &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #7F848E; font-style: italic\">// 当前粒子变小到一定程度之后，每次将它的半径+0.1，使其慢慢变大</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">radius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">futurRadius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&amp;&amp;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">dying</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">===</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">radius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">durVal</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                &#125; </span><span style=\"color: #C678DD\">else</span><span style=\"color: #ABB2BF\"> &#123; </span><span style=\"color: #7F848E; font-style: italic\">//粒子已经到达最大状态</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">dying</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">true</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #7F848E; font-style: italic\">//表示粒子还处于show状态</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #7F848E; font-style: italic\">//每次-0.1</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">dying</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">radius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">-=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">durVal</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #7F848E; font-style: italic\">// 画粒子形状</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">save</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">fillStyle</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">beginPath</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">fillRect</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">futurRadius</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">futurRadius</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">closePath</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">fill</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">restore</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #7F848E; font-style: italic\">//将消失的粒子重置最初的状态</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">||</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">radius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">base</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">base</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">dying</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">futurRadius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">randomInt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">1.1</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">5.1</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            &#125;</span></span></code></pre></div><p><strong>完整代码</strong></p>\n<div class=\"language-html\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">html</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #ABB2BF\">&lt;!</span><span style=\"color: #E06C75\">DOCTYPE</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">html</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E06C75\">html</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">lang</span><span style=\"color: #ABB2BF\">=</span><span style=\"color: #98C379\">&quot;en&quot;</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E06C75\">head</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;/</span><span style=\"color: #E06C75\">head</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;</span><span style=\"color: #E06C75\">body</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;</span><span style=\"color: #E06C75\">canvas</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">id</span><span style=\"color: #ABB2BF\">=</span><span style=\"color: #98C379\">&quot;dir&quot;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">width</span><span style=\"color: #ABB2BF\">=</span><span style=\"color: #98C379\">&quot;800&quot;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">height</span><span style=\"color: #ABB2BF\">=</span><span style=\"color: #98C379\">&quot;800&quot;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">style</span><span style=\"color: #ABB2BF\">=</span><span style=\"color: #98C379\">&quot;border:1px solid #ccc&quot;</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;/</span><span style=\"color: #E06C75\">canvas</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;</span><span style=\"color: #E06C75\">script</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">canvas</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">document</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">getElementById</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;dir&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">context</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">getContext</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&quot;2d&quot;</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">gridY</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">10</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">gridX</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">10</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">colors</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [</span><span style=\"color: #98C379\">&#39;#f44336&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#e91e63&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#9c27b0&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#673ab7&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#3f51b5&#39;</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #98C379\">&#39;#2196f3&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#03a9f4&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#00bcd4&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#009688&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#4CAF50&#39;</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #98C379\">&#39;#8BC34A&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#CDDC39&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#FFEB3B&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#FFC107&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;#FF9800&#39;</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #98C379\">&#39;#FF5722&#39;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            ],</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E06C75\">durVal</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">0.1</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #7F848E; font-style: italic\">// 粒子</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">Particle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75; font-style: italic\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75; font-style: italic\">y</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">colors</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #E5C07B\">Math</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">floor</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">Math</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">random</span><span style=\"color: #ABB2BF\">() </span><span style=\"color: #56B6C2\">*</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">colors</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">length</span><span style=\"color: #ABB2BF\">)]; </span><span style=\"color: #7F848E; font-style: italic\">//&#39;bleack&#39;//</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">futurRadius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">randomInt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">1.1</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">5.1</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">radius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">1.1</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">dying</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">base</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">drawParticle</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> () &#123;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #7F848E; font-style: italic\">// 当前粒子变小到一定程度之后，每次将它的半径+0.1，使其慢慢变大</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">radius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">futurRadius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&amp;&amp;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">dying</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">===</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">radius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">durVal</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                &#125; </span><span style=\"color: #C678DD\">else</span><span style=\"color: #ABB2BF\"> &#123; </span><span style=\"color: #7F848E; font-style: italic\">//粒子已经到达最大状态</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">dying</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">true</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #7F848E; font-style: italic\">//表示粒子还处于show状态</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #7F848E; font-style: italic\">//每次-0.1</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">dying</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">radius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">-=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">durVal</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #7F848E; font-style: italic\">// 画粒子形状</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">save</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">fillStyle</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">color</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">beginPath</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">fillRect</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">futurRadius</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">futurRadius</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">closePath</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">fill</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">restore</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #7F848E; font-style: italic\">//将消失的粒子重置最初的状态</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">||</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">radius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">base</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">base</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">];</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">dying</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">futurRadius</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">randomInt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">1.1</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">5.1</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">Shape</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75; font-style: italic\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75; font-style: italic\">y</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75; font-style: italic\">texte</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">200</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">text</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">texte</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">placement</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [];</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">Shape</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">prototype</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">getValue</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> () &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">textAlign</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;center&quot;</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">font</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">size</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&quot;px arial&quot;</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">fillText</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">text</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">x</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">y</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">idata</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">getImageData</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">); </span><span style=\"color: #7F848E; font-style: italic\">// 获取 canvas指定范围内的 像素数组</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">let</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">buffer32</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">Uint32Array</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">idata</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">data</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">buffer</span><span style=\"color: #ABB2BF\">); </span><span style=\"color: #7F848E; font-style: italic\">// 转成32位的数组</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #7F848E; font-style: italic\">// 遍历所有的数组 </span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">j</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">j</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">j</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">gridY</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">gridX</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    </span><span style=\"color: #C678DD\">if</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">buffer32</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #E06C75\">j</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">*</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\">]) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        </span><span style=\"color: #7F848E; font-style: italic\">// 放入粒子对象</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        </span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">ball</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">Particle</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">j</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                        </span><span style=\"color: #E5C07B\">this</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">placement</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">push</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">ball</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                    &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">clearRect</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">randomInt</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75; font-style: italic\">min</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75; font-style: italic\">max</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">return</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">Math</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">random</span><span style=\"color: #ABB2BF\">() </span><span style=\"color: #56B6C2\">*</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #E06C75\">max</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">-</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">min</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">+</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">word</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #C678DD\">new</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">Shape</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">/</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">/</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">2</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;文字粒子&#39;</span><span style=\"color: #ABB2BF\">)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        </span><span style=\"color: #E5C07B\">word</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">getValue</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        (</span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #61AFEF\">drawFrame</span><span style=\"color: #ABB2BF\">() &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">window</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">requestAnimationFrame</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">drawFrame</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #E5C07B\">context</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">clearRect</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">width</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E5C07B\">canvas</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">height</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            </span><span style=\"color: #C678DD\">for</span><span style=\"color: #ABB2BF\"> (</span><span style=\"color: #C678DD\">var</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #D19A66\">0</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">&lt;</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">word</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E5C07B\">placement</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">length</span><span style=\"color: #ABB2BF\">; </span><span style=\"color: #E06C75\">i</span><span style=\"color: #56B6C2\">++</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #7F848E; font-style: italic\">//调用particle对像的drawParticle方法，开始画布上画</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">                </span><span style=\"color: #E5C07B\">word</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #E06C75\">placement</span><span style=\"color: #ABB2BF\">[</span><span style=\"color: #E06C75\">i</span><span style=\"color: #ABB2BF\">].</span><span style=\"color: #61AFEF\">drawParticle</span><span style=\"color: #ABB2BF\">();</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">            &#125;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">        &#125;())</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    &lt;/</span><span style=\"color: #E06C75\">script</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;/</span><span style=\"color: #E06C75\">body</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&lt;/</span><span style=\"color: #E06C75\">html</span><span style=\"color: #ABB2BF\">&gt;</span></span>\n<span class=\"line\"></span></code></pre></div>","text":"最终实现效果 实现思路： 获取到canvas绘制后屏幕上像素点的数组，在目标像素点上绘制粒子替换掉原来的内容 绘制文字 通过API获取画布的二进制数组 设置粒子...","permalink":"/post/Canvas实现文字粒子效果","photos":[],"count_time":{"symbolsCount":"6.5k","symbolsTime":"6 mins."},"categories":[],"tags":[],"toc":"","author":{"name":"天然卷打工战士","slug":"blog-author","avatar":"https://pic-blog-1255296193.cos.ap-beijing.myqcloud.com/touxiang.jpg","link":"/","description":"未看此花时， <br> 此花与汝同归于寂； <br> 来看此花时， <br> 此花颜色一时明白过来。","socials":{"github":"https://github.com/tianranjuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{"title":"CocosCreator实现摄像机跟随移动","uid":"38463cdb58c9ed519678c1b1d62b6f8a","slug":"实现摄像机跟随移动","date":"2019-04-07T17:15:48.000Z","updated":"2025-09-28T09:23:30.322Z","comments":true,"path":"api/articles/实现摄像机跟随移动.json","keywords":null,"cover":[],"text":"如果只有一个摄像机的话，在Main Camera上添加脚本 这样的话就可以实现摄像机跟随主角移动而移动 ","permalink":"/post/实现摄像机跟随移动","photos":[],"count_time":{"symbolsCount":53,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"游戏开发","slug":"游戏开发","count":10,"path":"api/tags/游戏开发.json"}],"author":{"name":"天然卷打工战士","slug":"blog-author","avatar":"https://pic-blog-1255296193.cos.ap-beijing.myqcloud.com/touxiang.jpg","link":"/","description":"未看此花时， <br> 此花与汝同归于寂； <br> 来看此花时， <br> 此花颜色一时明白过来。","socials":{"github":"https://github.com/tianranjuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"git把某本地分支的某次修改修改到其他远程分支","uid":"6d5ec0ddb13963c47904e9839c9e31d9","slug":"git把某本地分支的某次修改修改到其他远程分支","date":"2019-03-28T08:18:56.000Z","updated":"2025-09-28T09:23:30.331Z","comments":true,"path":"api/articles/git把某本地分支的某次修改修改到其他远程分支.json","keywords":null,"cover":[],"text":"起因因为一次手残操作，在没看清分支的情况下把代码写在了一个错误分支上，并且把修改提交到了该分支上。在网上找了很多解决办法都不太好用，最后用下面的这个命令解决了这...","permalink":"/post/git把某本地分支的某次修改修改到其他远程分支","photos":[],"count_time":{"symbolsCount":387,"symbolsTime":"1 mins."},"categories":[],"tags":[],"author":{"name":"天然卷打工战士","slug":"blog-author","avatar":"https://pic-blog-1255296193.cos.ap-beijing.myqcloud.com/touxiang.jpg","link":"/","description":"未看此花时， <br> 此花与汝同归于寂； <br> 来看此花时， <br> 此花颜色一时明白过来。","socials":{"github":"https://github.com/tianranjuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}