{"title":"leaflet回放插件 leaflet-replayer","uid":"af2d422907556d678d4afd213578db93","slug":"leaflet-replayer插件","date":"2025-10-11T09:10:19.283Z","updated":"2025-10-11T09:15:18.459Z","comments":true,"path":"api/articles/leaflet-replayer插件.json","keywords":null,"cover":null,"content":"<p><a href=\"https://github.com/tianranjuan/leaflet-replayer\">插件地址</a></p>\n<p>根据之前项目中遇到的场景需求，开发了此插件，已发布到npm，欢迎大家使用。</p>\n<h2 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h2><p>Leaflet Replayer 是一个基于 Leaflet 的回放图层插件，允许你在地图上回放历史数据。</p>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><div class=\"language-bash\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">bash</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #61AFEF\">npm</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">install</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">leaflet-replayer</span></span></code></pre></div><p>或者直接下载项目中的 <code>index.js</code> 文件并在项目中引入。</p>\n<h2 id=\"使用方法\"><a href=\"#使用方法\" class=\"headerlink\" title=\"使用方法\"></a>使用方法</h2><h3 id=\"基本使用\"><a href=\"#基本使用\" class=\"headerlink\" title=\"基本使用\"></a>基本使用</h3><div class=\"language-javascript\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">javascript</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// 引入插件</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">import</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #98C379\">&#39;leaflet-replayer&#39;</span><span style=\"color: #ABB2BF\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// 创建回放图层实例</span></span>\n<span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">replayer</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">L</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">replayer</span><span style=\"color: #ABB2BF\">(&#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #E06C75\">myData</span><span style=\"color: #ABB2BF\">,         </span><span style=\"color: #7F848E; font-style: italic\">// 回放数据</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #E06C75\">step</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">1000</span><span style=\"color: #ABB2BF\">,           </span><span style=\"color: #7F848E; font-style: italic\">// 时间步长(毫秒)</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #E06C75\">speed</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">1</span><span style=\"color: #ABB2BF\">,             </span><span style=\"color: #7F848E; font-style: italic\">// 播放速度</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #E06C75\">autoPlay</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">,      </span><span style=\"color: #7F848E; font-style: italic\">// 是否自动播放</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #E06C75\">loop</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">,          </span><span style=\"color: #7F848E; font-style: italic\">// 是否循环播放</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #E06C75\">smoothSpeed</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">false</span><span style=\"color: #ABB2BF\">,   </span><span style=\"color: #7F848E; font-style: italic\">// 是否启用平滑倍速</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  </span><span style=\"color: #61AFEF\">onTick</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #C678DD\">function</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75; font-style: italic\">timestamp</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75; font-style: italic\">data</span><span style=\"color: #ABB2BF\">) &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #7F848E; font-style: italic\">// 每个时间点的回调函数</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E5C07B\">console</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">log</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #98C379\">&#39;当前时间:&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">timestamp</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #98C379\">&#39;数据:&#39;</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">&#125;).</span><span style=\"color: #61AFEF\">addTo</span><span style=\"color: #ABB2BF\">(</span><span style=\"color: #E06C75\">map</span><span style=\"color: #ABB2BF\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #7F848E; font-style: italic\">// 控制播放</span></span>\n<span class=\"line\"><span style=\"color: #E5C07B\">replayer</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">play</span><span style=\"color: #ABB2BF\">();   </span><span style=\"color: #7F848E; font-style: italic\">// 开始播放</span></span>\n<span class=\"line\"><span style=\"color: #E5C07B\">replayer</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">pause</span><span style=\"color: #ABB2BF\">();  </span><span style=\"color: #7F848E; font-style: italic\">// 暂停播放</span></span>\n<span class=\"line\"><span style=\"color: #E5C07B\">replayer</span><span style=\"color: #ABB2BF\">.</span><span style=\"color: #61AFEF\">stop</span><span style=\"color: #ABB2BF\">();   </span><span style=\"color: #7F848E; font-style: italic\">// 停止播放</span></span></code></pre></div><h3 id=\"数据格式\"><a href=\"#数据格式\" class=\"headerlink\" title=\"数据格式\"></a>数据格式</h3><p>数据应按照以下格式组织：</p>\n<div class=\"language-javascript\"><button title=\"Copy code\" class=\"copy\"></button><span class=\"lang\">javascript</span><pre class=\"shiki one-dark-pro\" style=\"background-color: #282c34\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #C678DD\">const</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #E5C07B\">myData</span><span style=\"color: #ABB2BF\"> </span><span style=\"color: #56B6C2\">=</span><span style=\"color: #ABB2BF\"> [</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">timestamp</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">1609459200000</span><span style=\"color: #ABB2BF\">, </span><span style=\"color: #7F848E; font-style: italic\">// 时间戳</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">: [...]               </span><span style=\"color: #7F848E; font-style: italic\">// 该时间点对应的数据</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  &#125;,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  &#123;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">timestamp</span><span style=\"color: #ABB2BF\">: </span><span style=\"color: #D19A66\">1609459300000</span><span style=\"color: #ABB2BF\">,</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">    </span><span style=\"color: #E06C75\">data</span><span style=\"color: #ABB2BF\">: [...]</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">  &#125;</span></span>\n<span class=\"line\"><span style=\"color: #ABB2BF\">];</span></span></code></pre></div><h3 id=\"配置选项\"><a href=\"#配置选项\" class=\"headerlink\" title=\"配置选项\"></a>配置选项</h3><table>\n<thead>\n<tr>\n<th>选项</th>\n<th>类型</th>\n<th>默认值</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>data</td>\n<td>Array</td>\n<td>[]</td>\n<td>需要回放的数据</td>\n</tr>\n<tr>\n<td>startTime</td>\n<td>Number</td>\n<td>null</td>\n<td>回放数据的开始时间</td>\n</tr>\n<tr>\n<td>endTime</td>\n<td>Number</td>\n<td>null</td>\n<td>回放数据的结束时间</td>\n</tr>\n<tr>\n<td>step</td>\n<td>Number</td>\n<td>1000</td>\n<td>回放数据的标准步长(毫秒)</td>\n</tr>\n<tr>\n<td>speed</td>\n<td>Number</td>\n<td>1</td>\n<td>回放数据的倍速</td>\n</tr>\n<tr>\n<td>autoPlay</td>\n<td>Boolean</td>\n<td>false</td>\n<td>是否自动播放</td>\n</tr>\n<tr>\n<td>loop</td>\n<td>Boolean</td>\n<td>false</td>\n<td>是否循环播放</td>\n</tr>\n<tr>\n<td>smoothSpeed</td>\n<td>Boolean</td>\n<td>false</td>\n<td>是否启用平滑倍速模式</td>\n</tr>\n<tr>\n<td>onTick</td>\n<td>Function</td>\n<td>null</td>\n<td>时间推进时的回调函数</td>\n</tr>\n<tr>\n<td>onStop</td>\n<td>Function</td>\n<td>null</td>\n<td>停止时的回调函数</td>\n</tr>\n<tr>\n<td>onPause</td>\n<td>Function</td>\n<td>null</td>\n<td>暂停时的回调函数</td>\n</tr>\n<tr>\n<td>onJumpTo</td>\n<td>Function</td>\n<td>null</td>\n<td>跳转时间时的回调函数</td>\n</tr>\n</tbody></table>\n<h3 id=\"API-方法\"><a href=\"#API-方法\" class=\"headerlink\" title=\"API 方法\"></a>API 方法</h3><ul>\n<li><code>play()</code> - 开始播放</li>\n<li><code>pause()</code> - 暂停播放</li>\n<li><code>stop()</code> - 停止播放并回到起始位置</li>\n<li><code>setSpeed(speed)</code> - 设置播放速度</li>\n<li><code>jumpTo(time)</code> - 跳转到指定时间点</li>\n<li><code>getState()</code> - 获取播放器当前状态</li>\n</ul>\n<h3 id=\"回调函数\"><a href=\"#回调函数\" class=\"headerlink\" title=\"回调函数\"></a>回调函数</h3><ul>\n<li><code>onTick(timestamp, data)</code> - 每个时间点触发，参数为当前时间戳和数据</li>\n<li><code>onStop(timestamp)</code> - 停止播放时触发</li>\n<li><code>onPause(timestamp)</code> - 暂停播放时触发</li>\n<li><code>onJumpTo(timestamp)</code> - 跳转时间时触发</li>\n</ul>\n","feature":true,"text":"插件地址 根据之前项目中遇到的场景需求，开发了此插件，已发布到npm，欢迎大家使用。 介绍Leaflet Replayer 是一个基于 Leaflet 的回放图...","permalink":"/post/leaflet-replayer插件","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[{"name":"leaflet","slug":"leaflet","count":1,"path":"api/categories/leaflet.json"}],"tags":[{"name":"leaflet","slug":"leaflet","count":1,"path":"api/tags/leaflet.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BB%8B%E7%BB%8D\"><span class=\"toc-text\">介绍</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85\"><span class=\"toc-text\">安装</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">使用方法</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">基本使用</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F\"><span class=\"toc-text\">数据格式</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9\"><span class=\"toc-text\">配置选项</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#API-%E6%96%B9%E6%B3%95\"><span class=\"toc-text\">API 方法</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0\"><span class=\"toc-text\">回调函数</span></a></li></ol></li></ol>","author":{"name":"天然卷打工战士","slug":"blog-author","avatar":"https://pic-blog-1255296193.cos.ap-beijing.myqcloud.com/touxiang.jpg","link":"/","description":"未看此花时， <br> 此花与汝同归于寂； <br> 来看此花时， <br> 此花颜色一时明白过来。","socials":{"github":"https://github.com/tianranjuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"多个div紧密排列的间隙问题","uid":"6d41b9e6354554d3613a2c8170bc7bc4","slug":"多个div紧密排列的间隙问题","date":"2025-09-29T15:27:23.263Z","updated":"2025-10-09T07:25:53.708Z","comments":true,"path":"api/articles/多个div紧密排列的间隙问题.json","keywords":null,"cover":"https://cdn.stocksnap.io/img-thumbs/280h/enchanting-forest_1CFKSWRR5X.jpg","text":"div 的行间缝隙在绘制cell时出现了 div 行间距非常大的问题 在查找资料后发现原因: 在 line-block 模式下，元素被当成行内元素排版，元素之间...","permalink":"/post/多个div紧密排列的间隙问题","photos":[],"count_time":{"symbolsCount":"1.4k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"JavaScript","slug":"JavaScript","count":5,"path":"api/tags/JavaScript.json"}],"author":{"name":"天然卷打工战士","slug":"blog-author","avatar":"https://pic-blog-1255296193.cos.ap-beijing.myqcloud.com/touxiang.jpg","link":"/","description":"未看此花时， <br> 此花与汝同归于寂； <br> 来看此花时， <br> 此花颜色一时明白过来。","socials":{"github":"https://github.com/tianranjuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true}}