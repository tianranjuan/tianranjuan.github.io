{"title":"OpenGL「一」：使用C++编写第一个OpenGL窗口程序","uid":"8d43fa0304d1f9bd1b2ad6d1921fba3a","slug":"OpenGL1","date":"2021-12-06T16:00:00.000Z","updated":"2021-12-25T15:34:44.000Z","comments":true,"path":"api/articles/OpenGL1.json","keywords":null,"cover":"https://images.pexels.com/photos/9501403/pexels-photo-9501403.jpeg?cs=srgb&dl=pexels-alena-beliaeva-9501403.jpg&fm=jpg","content":"<h1 id=\"环境准备\"><a href=\"#环境准备\" class=\"headerlink\" title=\"环境准备\"></a>环境准备</h1><ol>\n<li>VS2019</li>\n<li>GLFW</li>\n</ol>\n<h1 id=\"下载GLFW\"><a href=\"#下载GLFW\" class=\"headerlink\" title=\"下载GLFW\"></a>下载GLFW</h1><p>一个轻量级的，开源的，跨平台的library。支持OpenGL及OpenGL ES，用来管理窗口，读取输入，处理事件等功能。需要这个库的原因是OpenGL本身只是标准，所以并没有提供窗口管理的功能，所以需要使用工具来帮助我们开发，而GLFW就是其中不错的选择。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>GLFW名称具体含义没有查到，但是看功能应该是<code>OpenGl for window</code>，这里window不是指windows系统而是应用程序窗口的window。</p></blockquote>\n<h2 id=\"下载GLFW-1\"><a href=\"#下载GLFW-1\" class=\"headerlink\" title=\"下载GLFW\"></a>下载GLFW</h2><p><a href=\"https://www.glfw.org/download\">官方下载地址</a></p>\n<p><img src=\"/image/opengl/opengl/%E4%B8%8B%E8%BD%BD32%E4%BD%8DGLFW.png\" alt=\"选择下载32位的程序\"></p>\n<p>选择下载32位的程序</p>\n<p>下载完成后解压文件，这里我们主要关注<code>include</code>和<code>lib-vs2019</code>两个目录，分别是头文件位置和链接库位置。</p>\n<p><img src=\"/image/opengl/GLFW.png\" alt=\"GLFW\"></p>\n<div class=\"custom-quote tip\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06\"></path>\n<path stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 18H12.01\"></path>\n</svg></span>\n<p class=\"custom-quote-title\">提示</p>\n<p>如果使用的不是VS2019，选择对应版本的即可。</p>\n\n</div>\n<h1 id=\"在VS中创建C-工程\"><a href=\"#在VS中创建C-工程\" class=\"headerlink\" title=\"在VS中创建C++工程\"></a>在VS中创建C++工程</h1><p>打开VS，点击<code>创建新项目</code>-&gt;<code>C++空项目</code>点击下一步，起名<code>OpenGL</code>并选择好工程目录后点击<code>创建</code>。</p>\n<p><img src=\"/image/opengl/%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE.png\" alt=\"创建项目\"></p>\n<p>工程创建成功后，点击红框按钮切换视图并创建<code>src</code>文件夹以及<code>Application.cpp</code>文件</p>\n<p><img src=\"/image/opengl/%E6%96%B0%E5%BB%BAApplication.png\" alt=\"新建Application\"></p>\n<p>输入以下代码，按<code>F5</code>，测试工程是否能正常启动</p>\n<pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">#include &lt;iostream&gt;\n\nint main(void) &#123;\n\tstd::cout &lt;&lt; &quot;Hello&quot; &lt;&lt; std::endl;\n\tstd::cin.get();\n&#125;</code></pre>\n\n<p>确认启动正常后，复制GLFW的示例代码到<code>Application.cpp</code>中</p>\n<p><a href=\"https://www.glfw.org/documentation.html\">官方示例地址</a></p>\n<pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">#include &lt;GLFW&#x2F;glfw3.h&gt;\n\nint main(void)\n&#123;\n    GLFWwindow* window;\n\n    &#x2F;* Initialize the library *&#x2F;\n    if (!glfwInit())\n        return -1;\n\n    &#x2F;* Create a windowed mode window and its OpenGL context *&#x2F;\n    window &#x3D; glfwCreateWindow(640, 480, &quot;Hello World&quot;, NULL, NULL);\n    if (!window)\n    &#123;\n        glfwTerminate();\n        return -1;\n    &#125;\n\n    &#x2F;* Make the window&#39;s context current *&#x2F;\n    glfwMakeContextCurrent(window);\n\n    &#x2F;* Loop until the user closes the window *&#x2F;\n    while (!glfwWindowShouldClose(window))\n    &#123;\n        &#x2F;* Render here *&#x2F;\n        glClear(GL_COLOR_BUFFER_BIT);\n\n        &#x2F;* Swap front and back buffers *&#x2F;\n        glfwSwapBuffers(window);\n\n        &#x2F;* Poll for and process events *&#x2F;\n        glfwPollEvents();\n    &#125;\n\n    glfwTerminate();\n    return 0;\n&#125;</code></pre>\n\n<p>此时代码会全是异常，无法运行，所以开始配置GLFW环境。</p>\n<h1 id=\"配置GLFW环境\"><a href=\"#配置GLFW环境\" class=\"headerlink\" title=\"配置GLFW环境\"></a>配置GLFW环境</h1><p>首先，打开工程目录并在当前项目的上一级也就是解决方案的目录下(包含<code>OpenGL.sln</code>文件的目录)创建文件夹<code>Dependencies</code>用于存放各种依赖库。</p>\n<p>创建好<code>Dependencies</code>文件夹后，再创建<code>GLFW</code>文件夹，并把之前下载的<code>GLFW</code>压缩包中的<code>include</code>和<code>lib-vc2019</code>文件夹复制到<code>Dependencies\\GLFW</code>下</p>\n<p><img src=\"/image/opengl/%E4%BE%9D%E8%B5%96%E9%A1%B9.png\" alt=\"依赖项\"></p>\n<p>同时由于我们希望GLFW库是静态链接到我们的项目中，所以<code>lib-vc2019</code>文件夹中的<code>glfw3.dll</code>和<code>glfw3dll.lib</code>都可以删除掉，保持项目的干净。</p>\n<p><img src=\"/image/opengl/%E5%88%A0%E9%99%A4dll.png\" alt=\"删除dll\"></p>\n<p>第二步，<code>右键点击工程</code>-&gt;<code>属性</code>打开属性页。</p>\n<p><img src=\"/image/opengl/%E6%89%93%E5%BC%80%E5%B1%9E%E6%80%A7.png\" alt=\"打开属性\"></p>\n<p>然后点击<code>C/C++</code>-&gt;<code>常规</code>-&gt;<code>附加包含目录</code>配置包含目录为<code>Dependencies\\GLFW\\include</code>目录</p>\n<p><img src=\"/image/opengl/%E9%85%8D%E7%BD%AE%E5%8C%85%E5%90%AB%E7%9B%AE%E5%BD%95.png\" alt=\"配置包含目录\"></p>\n<p>第三步，类似<code>附加包含目录</code>我们继续配置链接器的目录</p>\n<p>点击<code>链接器</code>-&gt;<code>常规</code>-&gt;<code>附加库目录</code>配置包含目录为<code>Dependencies\\GLFW\\lib-vc2019</code>目录</p>\n<p><img src=\"/image/opengl/%E9%93%BE%E6%8E%A5%E5%BA%93%E7%9B%AE%E5%BD%95%E9%85%8D%E7%BD%AE.png\" alt=\"链接库目录配置\"></p>\n<p>再选择<code>链接器</code>-&gt;<code>输入</code>-&gt;<code>附加依赖项</code>，添加<code>glfw3.lib</code>作为附加库</p>\n<p><img src=\"/image/opengl/%E9%85%8D%E7%BD%AE%E9%93%BE%E6%8E%A5%E5%99%A8.png\" alt=\"配置链接器\"></p>\n<p>至此回到<code>Application.cpp</code>按<code>F7</code>间编译会发现没有报错了，再次按下<code>F5</code>可以正确的弹出OpenGL窗口。</p>\n<p><img src=\"/image/opengl/%E8%BF%90%E8%A1%8C%E6%88%90%E5%8A%9F.png\" alt=\"运行成功\"></p>\n<h1 id=\"绘制第一个三角形\"><a href=\"#绘制第一个三角形\" class=\"headerlink\" title=\"绘制第一个三角形\"></a>绘制第一个三角形</h1><p>为了体验OpenGL所以这里简单绘制了一个三角形在窗口中，代码如下：</p>\n<pre class=\"line-numbers language-c++\" data-language=\"c++\"><code class=\"language-c++\">#include &lt;GLFW&#x2F;glfw3.h&gt;\n\nint main(void) &#123;\n\t...\n\t&#x2F;* Loop until the user closes the window *&#x2F;\n\twhile (!glfwWindowShouldClose(window)) &#123;\n\t\t&#x2F;* Render here *&#x2F;\n\t\tglClear(GL_COLOR_BUFFER_BIT);\n        &#x2F;&#x2F; 绘制三角形\n\t\tglBegin(GL_TRIANGLES);\n\n\t\tglVertex2f(-0.5f, -0.5f);\n\t\tglVertex2f(0.0f, 0.5f);\n\t\tglVertex2f(0.5f, -0.5f);\n\n\t\tglEnd();\n        &#x2F;&#x2F; 绘制结束\n        ...\n\t&#125;\n    ...\n\treturn 0;\n&#125;</code></pre>\n\n<p>启动项目可以看到一个白色的三角形在窗口中央</p>\n<p><img src=\"/image/opengl/%E7%99%BD%E8%89%B2%E4%B8%89%E8%A7%92%E5%BD%A2.png\" alt=\"白色三角形\"></p>\n<div class=\"custom-quote danger\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M19.76 5.23C15.84 5.23 12 2 12 2C12 2 8.15996 5.23 4.23996 5.23C4.23996 5.23 1.86996 16.99 12 22C22.13 16.99 19.76 5.23 19.76 5.23Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12 8V13\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 16H12\"></path>\n</svg>\n</span>\n<p class=\"custom-quote-title\">特别注意</p>\n<p><p>这里绘制三角形的代码使用的是已经淘汰的legacy OpenGL(早期的固定管线时期)代码，并非是现代OpenGL语法，这里仅供展示用。</p>\n</p>\n</div>\n<p>至此关于GLFW的环境就全部搭建完毕了，以后会在此基础上开始后面的学习。</p>\n<hr>\n<h1 id=\"Bonus-关于链接器\"><a href=\"#Bonus-关于链接器\" class=\"headerlink\" title=\"[Bonus]关于链接器\"></a>[Bonus]关于链接器</h1><p>Cherno在这里进行了一个演示，就是把<code>附加依赖项</code>中的附加库全部删除掉了，只添加<code>glfw3.lib</code>作为附加库，此时代码不会报错，但是按下<code>F5</code>后在链接阶段会报很多错</p>\n<p><img src=\"/image/opengl/%E9%93%BE%E6%8E%A5%E5%BA%93%E6%8A%A5%E9%94%99.png\" alt=\"链接库报错\"></p>\n<p>这是由于缺少一些系统依赖库所导致的，面对这种情况只需要报错信息中蓝框中的部分（_之后，@之前）复制出来到百度搜索一下就可以很快的找到解决方案（其实就是微软官方文档）</p>\n<p><img src=\"/image/opengl/%E6%90%9C%E7%B4%A2%E9%94%99%E8%AF%AF.png\" alt=\"搜索错误\"></p>\n<p>点击进入文档后，滑动到最下面，找到对应的库名重新添加到<code>附加依赖项</code>即可</p>\n<p><img src=\"/image/opengl/%E6%96%87%E6%A1%A3%E5%AE%9A%E4%BD%8D.png\" alt=\"文档定位\"></p>\n<p>此例中报错原因是缺少<code>User32.lib</code>所导致的，所以将其添加到<code>附加依赖项</code>就可以解决问题。</p>\n","text":"环境准备 VS2019 GLFW 下载GLFW一个轻量级的，开源的，跨平台的library。支持OpenGL及OpenGL ES，用来管理窗口，读取输入，处理事件等功能。需要这个库的原因是OpenGL本身只是标准，所以并没有提供窗口管理的功能，所以需要使用工具来帮助我们开发，而G...","link":"","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"OpenGL","slug":"OpenGL","count":5,"path":"api/categories/OpenGL.json"}],"tags":[{"name":"游戏开发","slug":"游戏开发","count":10,"path":"api/tags/游戏开发.json"},{"name":"图形开发","slug":"图形开发","count":5,"path":"api/tags/图形开发.json"},{"name":"OpenGL","slug":"OpenGL","count":5,"path":"api/tags/OpenGL.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87\"><span class=\"toc-text\">环境准备</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BDGLFW\"><span class=\"toc-text\">下载GLFW</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%8B%E8%BD%BDGLFW-1\"><span class=\"toc-text\">下载GLFW</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%9C%A8VS%E4%B8%AD%E5%88%9B%E5%BB%BAC-%E5%B7%A5%E7%A8%8B\"><span class=\"toc-text\">在VS中创建C++工程</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AEGLFW%E7%8E%AF%E5%A2%83\"><span class=\"toc-text\">配置GLFW环境</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%BB%98%E5%88%B6%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%B8%89%E8%A7%92%E5%BD%A2\"><span class=\"toc-text\">绘制第一个三角形</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Bonus-%E5%85%B3%E4%BA%8E%E9%93%BE%E6%8E%A5%E5%99%A8\"><span class=\"toc-text\">[Bonus]关于链接器</span></a></li></ol>","author":{"name":"打工战士","slug":"blog-author","avatar":"https://cdn.u1.huluxia.com/g4/M03/19/CD/rBAAdmGuLfyAds0SAACW7BZxpZU096.jpg","link":"/","description":"未看此花时，此花与汝同归于寂 <br> 来看此花时，此花颜色一时明白过来","socials":{"github":"https://github.com/tianranjuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"OpenGL「二」：使用现代OpenGL","uid":"48f3ebc985f2f9c9c1a27375e29f50ed","slug":"OpenGL2","date":"2021-12-10T16:00:00.000Z","updated":"2021-12-25T15:34:52.000Z","comments":true,"path":"api/articles/OpenGL2.json","keywords":null,"cover":"https://images.unsplash.com/photo-1526336024174-e58f5cdd8e13?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=687&q=80","text":"在上一篇中我们已经使用OpenGL成功的在窗口中绘制了一个白色三角形，虽然非常简单，但是使用的代码却是OpenGL1.1版本的老代码，在2021的今天那肯定是不满足我们了，所以在这篇我们来看看如何引入现代的OpenGL API。 现在OpenGL在哪？前面说过OpenGL的本质是...","link":"","photos":[],"count_time":{"symbolsCount":"2.6k","symbolsTime":"2 mins."},"categories":[{"name":"OpenGL","slug":"OpenGL","count":5,"path":"api/categories/OpenGL.json"}],"tags":[{"name":"游戏开发","slug":"游戏开发","count":10,"path":"api/tags/游戏开发.json"},{"name":"图形开发","slug":"图形开发","count":5,"path":"api/tags/图形开发.json"},{"name":"OpenGL","slug":"OpenGL","count":5,"path":"api/tags/OpenGL.json"}],"author":{"name":"打工战士","slug":"blog-author","avatar":"https://cdn.u1.huluxia.com/g4/M03/19/CD/rBAAdmGuLfyAds0SAACW7BZxpZU096.jpg","link":"/","description":"未看此花时，此花与汝同归于寂 <br> 来看此花时，此花颜色一时明白过来","socials":{"github":"https://github.com/tianranjuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}},"next_post":{"title":"OpenGL「零」：什么是OpenGL","uid":"9297302560a828b99950be98432fa02c","slug":"OpenGL0","date":"2021-12-05T16:00:00.000Z","updated":"2021-12-07T13:20:38.000Z","comments":true,"path":"api/articles/OpenGL0.json","keywords":null,"cover":"https://images.pexels.com/photos/10071756/pexels-photo-10071756.jpeg?cs=srgb&dl=pexels-natalia-kolotvina-10071756.jpg&fm=jpg","text":" 提示 本系列内容全部来自Cherno的OpenGL系列视频，是对该系列内容的一个学习和总结，这个系列视频的目的是学习OpenGL的使用和思想，可能会使用非现代OpenGL的内容同时并不会实际开发一些可投入生产的库，所以代码仅供参考。 什么是OpenGLOpenGL一般被认为是一...","link":"","photos":[],"count_time":{"symbolsCount":971,"symbolsTime":"1 mins."},"categories":[{"name":"OpenGL","slug":"OpenGL","count":5,"path":"api/categories/OpenGL.json"}],"tags":[{"name":"游戏开发","slug":"游戏开发","count":10,"path":"api/tags/游戏开发.json"},{"name":"图形开发","slug":"图形开发","count":5,"path":"api/tags/图形开发.json"},{"name":"OpenGL","slug":"OpenGL","count":5,"path":"api/tags/OpenGL.json"}],"author":{"name":"打工战士","slug":"blog-author","avatar":"https://cdn.u1.huluxia.com/g4/M03/19/CD/rBAAdmGuLfyAds0SAACW7BZxpZU096.jpg","link":"/","description":"未看此花时，此花与汝同归于寂 <br> 来看此花时，此花颜色一时明白过来","socials":{"github":"https://github.com/tianranjuan","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}